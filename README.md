# НОВОГОДНИЙ БЛОГ

## Задание

Проект: Блог с комментариями, рейтингом, поиском, авторизацией, API.
Требования:
Авторизация пользователей
CRUD статей
Комментарии с иерархией
Поиск по заголовкам
Пагинация
API для получения статей (JSON)
Аватары пользователей
Валидация и обработка ошибок

## Ссылка на мини-демо
https://disk.yandex.ru/i/VBwBDi_EdIbUnw

В ходе разработки были полностью реализованы следующие модули:

### 1. Авторизация пользователей
- **Реализация:** `app/Http/Controllers/AuthController.php`.
- **Описание:** Система включает в себя регистрацию новых пользователей, аутентификацию (вход) и выход из системы. Используются стандартные сессии Laravel и защита паролей алгоритмом Bcrypt. Маршруты защищены middleware `auth` и `guest`.

### 2. CRUD статей
- **Реализация:** `app/Http/Controllers/ArticleController.php`.
- **Описание:**
    - **Create:** Добавление статей авторизованными пользователями.
    - **Read:** Просмотр списка статей и детальной страницы.
    - **Update/Delete:** Редактирование и удаление записей, доступное исключительно автору статьи.

### 3. Комментарии с иерархией
- **Реализация:** `app/Models/Comment.php`, `InteractionController.php`.
- **Описание:** Реализована древовидная структура комментариев с использованием поля `parent_id`. Пользователи могут отвечать на конкретные комментарии, создавая вложенные ветки обсуждений.

### 4. Регистронезависимый поиск
- **Реализация:** `app/Models/Article.php` (метод `booted`), `ArticleController.php`.
- **Описание:** Применена технология «теневого столбца» (`search_title`) (Через ILIKE, LOWER не получилось, пришлось использовать обходной путь)
    - При сохранении статьи PHP-метод `mb_strtolower` автоматически копирует заголовок в нижнем регистре в поле `search_title`.
    - Поиск осуществляется по этому полю, что гарантирует 100% корректную работу с кириллицей вне зависимости от настроек локали базы данных (найдет «Новый» по запросу «новый»).

### 5. Пагинация
- **Реализация:** `ArticleController.php`, метод `index`.
- **Описание:** Использован встроенный метод `paginate(6)`. Статьи разбиты на страницы по 6 штук для оптимальной нагрузки на браузер.

### 6. Рейтинг статей
- **Реализация:** `app/Models/Rating.php`, `InteractionController.php`.
- **Описание:** Система оценок от 1 до 5 звезд. Один пользователь может оставить только одну оценку для каждой статьи (используется метод `updateOrCreate`). Средний рейтинг рассчитывается автоматически.

### 7. Информационный профиль пользователя
- **Реализация:** `app/Http/Controllers/ProfileController.php`.
- **Описание:** Отдельная страница для редактирования личных данных: имени, адреса электронной почты, пароля и аватара.

### 8. Аватары пользователей
- **Реализация:** Интегрировано в профиль и регистрацию.
- **Описание:** Файлы изображений загружаются в защищенное хранилище `storage/app/public/avatars` и связываются с веб-директорией через символическую ссылку.

### 9. API для получения данных
- **Реализация:** `app/Http/Controllers/Api/ArticleApiController.php`, маршрут `/api/articles`.
- **Описание:** Возвращает список всех статей с данными авторов в формате JSON.

### 10. Валидация и обработка ошибок
- **Реализация:** Обработка через `$request->validate()` во всех контроллерах.
- **Описание:** Все входные данные проверяются на соответствие типам, длине и уникальности. Ошибки выводятся пользователю через интерактивные уведомления с возможностью их закрытия (UX-улучшение).

---

##  Инструкция по развертыванию

### Необходимое программное обеспечение:
1. **PHP 8.2 или выше.**
2. **Composer** (менеджер пакетов).
3. **PostgreSQL 15.**
4. **Homebrew** (для пользователей macOS).

### Шаги запуска приложения:

1.  **Клонирование и установка зависимостей:**
    ```bash
    composer install
    ```

2.  **Настройка базы данных:**
    Создайте базу данных в PostgreSQL и настройте файл `.env`:
    ```env
    DB_CONNECTION=pgsql
    DB_HOST=127.0.0.1
    DB_PORT=5432
    DB_DATABASE=название_вашей_бд
    DB_USERNAME=ваше_имя_пользователя
    DB_PASSWORD=ваш_пароль
    ```

3.  **Генерация ключа и миграции:**
    ```bash
    php artisan key:generate
    php artisan migrate:fresh --force
    ```

4.  **Создание ссылки на хранилище файлов:**
    ```bash
    php artisan storage:link
    ```

5.  **Запуск локального сервера:**
    ```bash
    php artisan serve
    ```

Приложение будет доступно по адресу: **http://127.0.0.1:8000**
